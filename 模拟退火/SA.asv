route = randperm(numberofcities);
temperature = 1000;
cooling_rate = 0.95;
Titerations = 1;
previous_distance = totaldistance(route);
while temperature > 1.0
    temp_route = perturb(route, 'reverse');
    current_distance = totaldistance(temp_route);
    diff = current_distance - previous_distance;
    if (diff<0) || (rand<exp(-diff/temperature))
        route = temp_route;
        previous_distance = current_distance;
        Titerations = Titerations + 1;
    end
    if Titerations >= 10    % Ã¿10²½½µÎÂ
        temperature = cooling_rate*temperature;
        Titerations = 0;
    end
end